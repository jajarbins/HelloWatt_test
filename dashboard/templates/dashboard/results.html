{% extends 'dashboard/results_base.html' %}

{% csrf_token %}

{% load static %}

{% block style %}
    <link rel="stylesheet" href="{% static 'dashboard/css/results.css' %}" media="all"/>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Mon tableau de bord énergie</h1>
    </div>
</div>

<select id="year_selection" name="year_selection">
    {% for year in available_years %}
        <option value="{{ year }}">{{ year }}</option>
    {% endfor %}
</select>

<div class="row">
    <div class="col-lg-12">
        <p>dépenses annuelles: {{ annual_costs }} €</p>

        {% if is_elec_heating %}
            <p>Vous utilisez un chauffage électrique</p>
        {% endif %}

        {% if dysfunction_detected %}
            <p>{{ dysfunction_detected }}</p>
        {% endif %}

        <p></p>
    </div>

</div>


<div style="display:inline-block;width: 61.8%;margin-top: 15px">
    <div>
        {{conso_watt_graph|safe}}
    </div>
</div>

{% endblock %}

<script>
        $( "#selection-button" ).click(function(event) {
            event.preventDefault();
            var airlineSelected = $('#airline-selected').find(":selected").val();

            $.ajax({
                url: "{% url 'charts_data' %}",
                method: 'GET',
                filter_category: parseInt(airlineSelected),
                success: function(data){
                console.log(data);
         },
                error: function(error_data){
                console.log("error");
                console.log(error_data);
         }
            })
        });
</script>

{% block script %}
    <script src="{% static 'dashboard/js/results.js' %}"></script>
{% endblock %}